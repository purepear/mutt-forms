var Mutt=function(){"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var Validator=function(){function Validator(messages){_classCallCheck(this,Validator),this.error=null,this.messages={required:"This field is required."},messages&&Object.assign(this.messages,messages)}return Validator.prototype.validate=function validate(){return!0},Validator}(),RequiredValidator=function(_Validator){function RequiredValidator(){return _classCallCheck(this,RequiredValidator),_possibleConstructorReturn(this,_Validator.apply(this,arguments))}return _inherits(RequiredValidator,_Validator),RequiredValidator.prototype.validate=function validate(value){return!(!value&&0!==value)||(this.error=this.messages.required,!1)},RequiredValidator}(Validator),BooleanRequiredValidator=function(_Validator2){function BooleanRequiredValidator(){return _classCallCheck(this,BooleanRequiredValidator),_possibleConstructorReturn(this,_Validator2.apply(this,arguments))}return _inherits(BooleanRequiredValidator,_Validator2),BooleanRequiredValidator.prototype.validate=function validate(value){return!0===value||!1===value||(this.error=this.messages.required,!1)},BooleanRequiredValidator}(Validator),BooleanTrueValidator=function(_Validator3){function BooleanTrueValidator(){return _classCallCheck(this,BooleanTrueValidator),_possibleConstructorReturn(this,_Validator3.apply(this,arguments))}return _inherits(BooleanTrueValidator,_Validator3),BooleanTrueValidator.prototype.validate=function validate(value){return!0===value||(this.error=this.messages.required,!1)},BooleanTrueValidator}(Validator),LengthValidator=function(_Validator4){function LengthValidator(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref$min=_ref.min,min=void 0===_ref$min?null:_ref$min,_ref$max=_ref.max,max=void 0===_ref$max?null:_ref$max,_ref$messages=_ref.messages,messages=void 0===_ref$messages?null:_ref$messages;_classCallCheck(this,LengthValidator);var _this4=_possibleConstructorReturn(this,_Validator4.call(this,messages));return _this4.min=min,_this4.max=max,_this4.messages.hasOwnProperty("minLength")||(_this4.messages.minLength="Length must be at least "+_this4.min+"!"),_this4.messages.hasOwnProperty("maxLength")||(_this4.messages.maxLength="Length must be no more than "+_this4.max+"!"),_this4}return _inherits(LengthValidator,_Validator4),LengthValidator.prototype.validate=function validate(value){return value?this.min&&value.length<this.min?(this.error=this.messages.minLength,!1):!(this.max&&value.length>this.max)||(this.error=this.messages.maxLength,!1):(this.error=this.messages.required,!1)},LengthValidator}(Validator),IntegerValidator=function(_Validator5){function IntegerValidator(messages){_classCallCheck(this,IntegerValidator);var _this5=_possibleConstructorReturn(this,_Validator5.call(this,messages));return _this5.messages.hasOwnProperty("intRequired")||(_this5.messages.intRequired="Value must be an integer"),_this5}return _inherits(IntegerValidator,_Validator5),IntegerValidator.prototype.validate=function validate(value){return!value||!isNaN(value)||(this.error=this.messages.intRequired,!1)},IntegerValidator}(Validator),RegexValidator=function(_Validator6){function RegexValidator(pattern,messages){_classCallCheck(this,RegexValidator);var _this6=_possibleConstructorReturn(this,_Validator6.call(this,messages));if(_this6.pattern=pattern,!_this6.messages.hasOwnProperty("invalidPattern")){var msg="Value must match the pattern: "+_this6.pattern;_this6.messages.invalidPattern=msg}return _this6}return _inherits(RegexValidator,_Validator6),RegexValidator.prototype.validate=function validate(value){return value?!!value.match(this.pattern)||(this.error=this.messages.invalidPattern,!1):(this.error=this.messages.required,!1)},RegexValidator}(Validator),AlphaValidator=function(_Validator7){function AlphaValidator(){var _ref2=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref2$min=_ref2.min,min=void 0===_ref2$min?2:_ref2$min,_ref2$max=_ref2.max,max=void 0===_ref2$max?25:_ref2$max,_ref2$messages=_ref2.messages,messages=void 0===_ref2$messages?null:_ref2$messages;_classCallCheck(this,AlphaValidator);var _this7=_possibleConstructorReturn(this,_Validator7.call(this,messages));return _this7.min=min,_this7.max=max,_this7}return _inherits(AlphaValidator,_Validator7),AlphaValidator.prototype.validate=function validate(value){return value?(value=value.trim()).length<this.min?(this.error="Must be more than 2 characters.",!1):value.length>this.max?(this.error="Must be less than 25 characters.",!1):!!value.match(/^[a-zA-Z\s]+$/)||(this.error="Only letters and spaces can be used.",!1):(this.error=this.messages.required,!1)},AlphaValidator}(Validator),validators=Object.freeze({Validator:Validator,RequiredValidator:RequiredValidator,BooleanRequiredValidator:BooleanRequiredValidator,BooleanTrueValidator:BooleanTrueValidator,LengthValidator:LengthValidator,IntegerValidator:IntegerValidator,RegexValidator:RegexValidator,AlphaValidator:AlphaValidator}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var Field=function(){function Field(_ref){var id=_ref.id,name=_ref.name,_ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$initial=_ref.initial,initial=void 0===_ref$initial?null:_ref$initial,_ref$widget=_ref.widget,widget=void 0===_ref$widget?null:_ref$widget,_ref$validators=_ref.validators,validators=void 0===_ref$validators?[]:_ref$validators,_ref$attribs=_ref.attribs,attribs=void 0===_ref$attribs?{}:_ref$attribs,_ref$description=_ref.description,description=void 0===_ref$description?null:_ref$description,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,_ref$order=_ref.order,order=void 0===_ref$order?null:_ref$order,_ref$parent=_ref.parent,parent=void 0===_ref$parent?null:_ref$parent;!function _classCallCheck$1(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Field),this.id=id,this.name=name,this.label=label,this.description=description,this.attribs=attribs,this.options=options,this.validators=validators,this.sortOrder=order,this.locked=!1,this.parent=parent,this.label||(this.label=this.name),this.initOptions();var WidgetKlass=this.getWidget();widget&&(WidgetKlass=widget);var initalValue=initial||this.initialValue();this.widget=new WidgetKlass(this,this.type,this.id,this.name,this.label,this.attribs,this.options,initalValue),this._errors=[]}return Field.prototype.initOptions=function initOptions(){this.options.hasOwnProperty("order")&&(this.sortOrder=this.options.order),this.options.hasOwnProperty("label")&&(this.label=this.options.label),this.options.hasOwnProperty("description")&&(this.description=this.options.description)},Field.prototype.render=function render(){return this.widget.render()},Field.prototype.destroy=function destroy(){return this.widget.destroy()},Field.prototype.postRender=function postRender(){this.widget.postRender()},Field.prototype.validate=function validate(){this.refreshValidationState();var value=this.value,_iterator=this.validators,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref2=_i.value}var validator=_ref2;if(!validator.validate(value)){this.errors=validator.error;break}}return!(this.errors.length>0)||(this.widget.refreshErrorState(this.errors),!1)},Field.prototype.lock=function lock(){return!this.locked&&(this.widget.lock(),this.locked=!0,!0)},Field.prototype.unlock=function unlock(){return!!this.locked&&(this.widget.unlock(),this.locked=!1,!0)},Field.prototype.refreshValidationState=function refreshValidationState(){var update=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._errors=[],this.widget.errors=[],update&&this.widget.refreshErrorState([])},Field.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("text")},Field.prototype.getSortOrder=function getSortOrder(){return this.sortOrder},Field.prototype.getSerializedValue=function getSerializedValue(){if(!this.options.hasOwnProperty("serialize"))return this.value;var serializeArgs=this.options.serialize,serializeKey=void 0,serializeOptions={};return"object"===(void 0===serializeArgs?"undefined":_typeof(serializeArgs))?(serializeKey=serializeArgs.name,serializeOptions=serializeArgs):serializeKey=serializeArgs,Mutt.config.hasSerializer(serializeKey)?new(Mutt.config.getSerializer(serializeKey))(this.value,serializeOptions).serialize():void 0},Field.prototype.setSortOrder=function setSortOrder(order){this.sortOrder=order},Field.prototype.toString=function toString(){return"Field <"+this.name+" "+this.type+">"},Field.prototype.updateId=function updateId(newId){var updateWidget=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],oldId=this.id;this.id=newId,updateWidget&&this.widget.updateId(oldId,newId)},Field.prototype.updateName=function updateName(newName){var updateWidget=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.name=newName,updateWidget&&this.widget.updateName(newName)},Field.prototype.initialValue=function initialValue(){return null},Field.new=function _new(id,name,schema){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},parent=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,required=arguments.length>5&&void 0!==arguments[5]&&arguments[5],fieldSpec={id:id,name:name,options:options,attribs:{},parent:parent,validators:[]},FieldKlass=null;if(schema.description&&(fieldSpec.description=schema.description),schema.title&&(fieldSpec.label=schema.title),schema.default&&(fieldSpec.initial=schema.default),schema.enum){var choices=[],_iterator2=schema.enum,_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref3;if(_isArray2){if(_i2>=_iterator2.length)break;_ref3=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref3=_i2.value}var option=_ref3;choices.push([option,option])}fieldSpec.choices=choices,FieldKlass=Mutt.config.getField("enum")}if(options.hasOwnProperty("hidden")&&options.hidden&&(fieldSpec.widget=Mutt.config.getWidget("hidden")),schema.format&&Mutt.config.hasWidget(schema.format)&&(fieldSpec.widget=Mutt.config.getWidget(schema.format)),options.widget&&Mutt.config.hasWidget(options.widget)&&(fieldSpec.widget=Mutt.config.getWidget(options.widget)),schema.items&&(fieldSpec.items=schema.items),schema.properties&&(fieldSpec.properties=schema.properties),required||options.hasOwnProperty("required")&&options.required){if("boolean"===schema.type){var BoolValidator=Mutt.config.getValidator("booleanRequired");fieldSpec.validators.push(new BoolValidator)}else{var RequiredValidator$$1=Mutt.config.getValidator("required");fieldSpec.validators.push(new RequiredValidator$$1)}fieldSpec.attribs.required="true"}if(schema.required&&(fieldSpec.required=schema.required),options.validators){var _iterator3=options.validators,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref4;if(_isArray3){if(_i3>=_iterator3.length)break;_ref4=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref4=_i3.value}var validator=_ref4;if("object"===(void 0===validator?"undefined":_typeof(validator)))if(validator instanceof Validator)fieldSpec.validators.push(validator);else if(validator.hasOwnProperty("name")){var Validator$$1=Mutt.config.getValidator(validator.name),validatorArgs={};validator.hasOwnProperty("args")&&(validatorArgs=validator.args),fieldSpec.validators.push(new Validator$$1(validatorArgs))}}}if(schema.hasOwnProperty("minItems")&&(fieldSpec.minItems=schema.minItems),schema.hasOwnProperty("maxItems")&&(fieldSpec.maxItems=schema.maxItems),options.attribs&&(fieldSpec.attribs=Object.assign(fieldSpec.attribs,options.attribs)),!FieldKlass){if(!Mutt.config.hasField(schema.type))return null;FieldKlass=Mutt.config.getField(schema.type)}return new FieldKlass(fieldSpec)},_createClass(Field,[{key:"type",get:function get(){var type=this.constructor.name.toLowerCase();return"field"!==type?type.replace("field",""):type},set:function set(someType){throw new Error("Unable to set type on a field instance!")}},{key:"value",get:function get(){return this.widget.getValue()},set:function set(value){this.widget.setValue(value)}},{key:"errors",get:function get(){return this._errors},set:function set(error){this._errors.push(error)}}]),Field}();var Fieldset=function(){function Fieldset(_ref){var _ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$name=_ref.name,name=void 0===_ref$name?null:_ref$name;!function _classCallCheck$2(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Fieldset),this.name=name,this.label=label,this.fields=[],this.errors={}}return Fieldset.prototype.addField=function addField(field){this.fields.push(field)},Fieldset.prototype.hasField=function hasField(fieldName){for(var field in this.fields)if(field.name===fieldName)return!0;return!1},Fieldset.prototype.data=function data(){var data={},_iterator=this.fields,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref2=_i.value}var field=_ref2;data[field.name]=field.getSerializedValue()}return data},Fieldset.prototype.populate=function populate(data){var _iterator2=this.fields,_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref3;if(_isArray2){if(_i2>=_iterator2.length)break;_ref3=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref3=_i2.value}var field=_ref3;data.hasOwnProperty(field.name)&&(field.value=data[field.name])}},Fieldset.prototype.validate=function validate(){var valid=!0,_iterator3=this.fields,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref4;if(_isArray3){if(_i3>=_iterator3.length)break;_ref4=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref4=_i3.value}var field=_ref4;field.validate()||(this.errors[field.name]=field.errors,valid=!1)}return valid},Fieldset.prototype.setFieldErrors=function setFieldErrors(errors){for(var errorField in errors)this.hasField(errorField)&&this.getField(errorField)},Fieldset.prototype.setLegend=function setLegend(legend){this.label=legend},Fieldset.prototype.refreshValidationState=function refreshValidationState(){this.errors={};var _iterator4=this.fields,_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref5;if(_isArray4){if(_i4>=_iterator4.length)break;_ref5=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref5=_i4.value}_ref5.refreshValidationState()}},Fieldset.prototype.render=function render(){var fieldsetContainer=document.createDocumentFragment(),fieldset=document.createElement("fieldset");if(fieldset.classList.add("mutt-fieldset"),this.name&&fieldset.setAttribute("name",this.name),this.label){var legend=document.createElement("legend");legend.textContent=this.label,fieldset.appendChild(legend)}this.fields.sort(function(a,b){return a.getSortOrder()-b.getSortOrder()});var _iterator5=this.fields,_isArray5=Array.isArray(_iterator5),_i5=0;for(_iterator5=_isArray5?_iterator5:_iterator5[Symbol.iterator]();;){var _ref6;if(_isArray5){if(_i5>=_iterator5.length)break;_ref6=_iterator5[_i5++]}else{if((_i5=_iterator5.next()).done)break;_ref6=_i5.value}var fieldElement=_ref6.render();fieldset.appendChild(fieldElement)}return fieldsetContainer.appendChild(fieldset),fieldsetContainer},Fieldset.prototype.postRender=function postRender(){var _iterator6=this.fields,_isArray6=Array.isArray(_iterator6),_i6=0;for(_iterator6=_isArray6?_iterator6:_iterator6[Symbol.iterator]();;){var _ref7;if(_isArray6){if(_i6>=_iterator6.length)break;_ref7=_iterator6[_i6++]}else{if((_i6=_iterator6.next()).done)break;_ref7=_i6.value}_ref7.postRender()}},Fieldset.prototype.lock=function lock(){var _iterator7=this.fields,_isArray7=Array.isArray(_iterator7),_i7=0;for(_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref8;if(_isArray7){if(_i7>=_iterator7.length)break;_ref8=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)break;_ref8=_i7.value}_ref8.lock()}},Fieldset.prototype.unlock=function unlock(){var _iterator8=this.fields,_isArray8=Array.isArray(_iterator8),_i8=0;for(_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref9;if(_isArray8){if(_i8>=_iterator8.length)break;_ref9=_iterator8[_i8++]}else{if((_i8=_iterator8.next()).done)break;_ref9=_i8.value}_ref9.unlock()}},Fieldset.prototype.getFieldByPath=function getFieldByPath(path){var pathParts=path.split("."),searchName=pathParts.shift(),_iterator9=this.fields,_isArray9=Array.isArray(_iterator9),_i9=0;for(_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref10;if(_isArray9){if(_i9>=_iterator9.length)break;_ref10=_iterator9[_i9++]}else{if((_i9=_iterator9.next()).done)break;_ref10=_i9.value}var field=_ref10;if(field.name===searchName){var fieldProto=field.constructor.prototype;if(0===pathParts.length)return field;if(fieldProto.hasOwnProperty("getFieldByPath"))return field.getFieldByPath(pathParts.join("."))}}return null},Fieldset.new=function _new(schema){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},fields=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,name=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,label=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,fieldsetSpec={name:name};schema.hasOwnProperty("title")&&(fieldsetSpec.label=schema.title),options.hasOwnProperty("form")&&options.form.hasOwnProperty("label")&&(fieldsetSpec.label=options.form.label),null!==label&&(fieldsetSpec.label=label),Object.assign(fieldsetSpec,options),schema.hasOwnProperty("properties")&&(schema=schema.properties);var fieldset=new Fieldset(fieldsetSpec),fieldIndex=1,_iterator10=Object.keys(schema),_isArray10=Array.isArray(_iterator10),_i10=0;for(_iterator10=_isArray10?_iterator10:_iterator10[Symbol.iterator]();;){var _ref11;if(_isArray10){if(_i10>=_iterator10.length)break;_ref11=_iterator10[_i10++]}else{if((_i10=_iterator10.next()).done)break;_ref11=_i10.value}var fieldName=_ref11,fieldId=fieldName+"_field_"+fieldIndex,fieldSchema=schema[fieldName],fieldOptions={};if(!fields||Object.keys(fields).includes(fieldName)){options.fields&&options.fields.hasOwnProperty(fieldName)&&(fieldOptions=options.fields[fieldName]),options.fieldsets&&(fieldOptions.fieldsets=options.fieldsets);var field=Field.new(fieldId,fieldName,fieldSchema,fieldOptions);field&&(field.getSortOrder()||field.setSortOrder(fieldIndex),fieldset.addField(field),fieldIndex++)}}return fieldset},Fieldset}();var MuttForm=function(){function MuttForm(schema){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function _classCallCheck$3(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MuttForm),this.schema=schema,this.options={},this.callbacks={},options&&options.hasOwnProperty("form")&&(this.options=options.form),this.mount=!1,this.multipart=!1,this.id=null,this.locked=!1,this.form=null,this.fieldsets=[],this.buttons={submit:null},this.build(schema,options)}return MuttForm.prototype.build=function build(schema){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(options.hasOwnProperty("fieldsets")){var fieldsetIndex=0,_iterator=options.fieldsets,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var fieldsetSpec=_ref,fieldsetFields=null,fieldsetLabel=null;fieldsetSpec.hasOwnProperty("fields")&&(fieldsetFields=fieldsetSpec.fields),fieldsetSpec.hasOwnProperty("fieldsets")&&(options.fieldsets=fieldsetSpec.fieldsets),fieldsetSpec.options&&fieldsetSpec.options.hasOwnProperty("label")&&(fieldsetLabel=fieldsetSpec.options.label);var fieldset=Fieldset.new(schema,options,fieldsetFields,"mutt-fieldset-"+fieldsetIndex,fieldsetLabel);this.fieldsets.push(fieldset),fieldsetIndex++}}else{var _fieldset=Fieldset.new(schema,options);this.fieldsets.push(_fieldset)}},MuttForm.prototype.data=function data(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var _data=[],_iterator2=this.fieldsets,_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref2=_i2.value}var fieldset=_ref2;_data.push(fieldset.data())}return _data}var data={},_iterator3=this.fieldsets,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref3;if(_isArray3){if(_i3>=_iterator3.length)break;_ref3=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref3=_i3.value}var _fieldset2=_ref3;data=Object.assign(data,_fieldset2.data())}return data},MuttForm.prototype.populate=function populate(data){var _iterator4=this.fieldsets,_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref4;if(_isArray4){if(_i4>=_iterator4.length)break;_ref4=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref4=_i4.value}_ref4.populate(data)}},MuttForm.prototype.render=function render(mount){var _this=this;return this.mount=mount,new Promise(function(resolve){var formContainer=document.createDocumentFragment();_this.form=document.createElement("form"),_this.id&&_this.form.setAttribute("id",_this.id),_this.form.setAttribute("method","POST"),_this.form.setAttribute("action",""),_this.form.setAttribute("class","mutt-form"),_this.multipart&&_this.form.setAttribute("enctype","multipart/form-data");var _iterator5=_this.fieldsets,_isArray5=Array.isArray(_iterator5),_i5=0;for(_iterator5=_isArray5?_iterator5:_iterator5[Symbol.iterator]();;){var _ref5;if(_isArray5){if(_i5>=_iterator5.length)break;_ref5=_iterator5[_i5++]}else{if((_i5=_iterator5.next()).done)break;_ref5=_i5.value}var fieldsetElement=_ref5.render();_this.form.appendChild(fieldsetElement)}var buttonClass="mutt-button",buttonText="Submit";if(_this.options.hasOwnProperty("buttons")&&_this.options.buttons.hasOwnProperty("submit")){if(_this.options.buttons.submit.hasOwnProperty("class"))buttonClass=buttonClass+" "+_this.options.buttons.submit.class;_this.options.buttons.submit.hasOwnProperty("text")&&(buttonText=_this.options.buttons.submit.text)}var buttonWrapper=document.createElement("div");if(buttonWrapper.setAttribute("class","mutt-button-wrapper"),_this.options.hasOwnProperty("buttons")){var _iterator6=Object.keys(_this.options.buttons),_isArray6=Array.isArray(_iterator6),_i6=0;for(_iterator6=_isArray6?_iterator6:_iterator6[Symbol.iterator]();;){var _ref6;if(_isArray6){if(_i6>=_iterator6.length)break;_ref6=_iterator6[_i6++]}else{if((_i6=_iterator6.next()).done)break;_ref6=_i6.value}var buttonName=_ref6;if("submit"!==buttonName){var buttonSpec=_this.options.buttons[buttonName],button=document.createElement("button");button.setAttribute("name",buttonName),button.setAttribute("class",buttonSpec.class),button.setAttribute("type","button"),button.textContent=buttonSpec.text,button.onclick=buttonSpec.callback,_this.buttons[buttonName]=button,buttonWrapper.appendChild(button)}}}var submitButton=document.createElement("button");submitButton.setAttribute("class",buttonClass),submitButton.setAttribute("type","submit"),submitButton.textContent=buttonText,submitButton.onclick=function(e){return _this.submit(e),!1},_this.buttons.submit=submitButton,buttonWrapper.appendChild(submitButton),_this.form.appendChild(buttonWrapper),formContainer.appendChild(_this.form),_this.mount.appendChild(formContainer);var _iterator7=_this.fieldsets,_isArray7=Array.isArray(_iterator7),_i7=0;for(_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref7;if(_isArray7){if(_i7>=_iterator7.length)break;_ref7=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)break;_ref7=_i7.value}_ref7.postRender()}resolve(_this)})},MuttForm.prototype.destroy=function destroy(){if(this.mount){var form=this.mount.querySelector("form");return this.mount.removeChild(form),!0}return!1},MuttForm.prototype.validate=function validate(){var valid=!0,errors=[],_iterator8=this.fieldsets,_isArray8=Array.isArray(_iterator8),_i8=0;for(_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref8;if(_isArray8){if(_i8>=_iterator8.length)break;_ref8=_iterator8[_i8++]}else{if((_i8=_iterator8.next()).done)break;_ref8=_i8.value}var fieldset=_ref8;fieldset.validate()||(errors.push(fieldset.errors),valid=!1)}return Mutt.logger("Validation -> Status "+valid+" -> "+JSON.stringify(errors)),valid},MuttForm.prototype.refreshValidationState=function refreshValidationState(){var _iterator9=this.fieldsets,_isArray9=Array.isArray(_iterator9),_i9=0;for(_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref9;if(_isArray9){if(_i9>=_iterator9.length)break;_ref9=_iterator9[_i9++]}else{if((_i9=_iterator9.next()).done)break;_ref9=_i9.value}_ref9.refreshValidationState()}},MuttForm.prototype.submit=function submit(event){var valid=!1;try{valid=this.validate()}catch(e){return Mutt.logger("Unable to validate prior to submit!",e),!1}return!!valid&&(Mutt.logger("Submit form"),this.callbacks.hasOwnProperty("submit")?this.callbacks.submit(this.data(),event):this.form.submit(),!0)},MuttForm.prototype.lock=function lock(){Mutt.logger("Locking form");var _iterator10=this.fieldsets,_isArray10=Array.isArray(_iterator10),_i10=0;for(_iterator10=_isArray10?_iterator10:_iterator10[Symbol.iterator]();;){var _ref10;if(_isArray10){if(_i10>=_iterator10.length)break;_ref10=_iterator10[_i10++]}else{if((_i10=_iterator10.next()).done)break;_ref10=_i10.value}_ref10.lock()}},MuttForm.prototype.unlock=function unlock(){Mutt.log("Unlocking form");var _iterator11=this.fieldsets,_isArray11=Array.isArray(_iterator11),_i11=0;for(_iterator11=_isArray11?_iterator11:_iterator11[Symbol.iterator]();;){var _ref11;if(_isArray11){if(_i11>=_iterator11.length)break;_ref11=_iterator11[_i11++]}else{if((_i11=_iterator11.next()).done)break;_ref11=_i11.value}_ref11.unlock()}},MuttForm.prototype.on=function on(hook,callback){return this.callbacks[hook]=callback,this},MuttForm.prototype.setFormId=function setFormId(formId){this.id=formId},MuttForm.prototype.getFormId=function getFormId(){return this.id},MuttForm.prototype.setFieldErrors=function setFieldErrors(errors){var _iterator12=this.fieldsets,_isArray12=Array.isArray(_iterator12),_i12=0;for(_iterator12=_isArray12?_iterator12:_iterator12[Symbol.iterator]();;){var _ref12;if(_isArray12){if(_i12>=_iterator12.length)break;_ref12=_iterator12[_i12++]}else{if((_i12=_iterator12.next()).done)break;_ref12=_i12.value}_ref12.setFieldErrors(errors)}},MuttForm.prototype.getFieldByPath=function getFieldByPath(path){var _iterator13=this.fieldsets,_isArray13=Array.isArray(_iterator13),_i13=0;for(_iterator13=_isArray13?_iterator13:_iterator13[Symbol.iterator]();;){var _ref13;if(_isArray13){if(_i13>=_iterator13.length)break;_ref13=_iterator13[_i13++]}else{if((_i13=_iterator13.next()).done)break;_ref13=_i13.value}var field=_ref13.getFieldByPath(path);if(field)return field}},MuttForm}(),isMergeableObject=function isMergeableObject(value){return function isNonNullObject(value){return!!value&&"object"==typeof value}(value)&&!function isSpecial(value){var stringValue=Object.prototype.toString.call(value);return"[object RegExp]"===stringValue||"[object Date]"===stringValue||function isReactElement(value){return value.$$typeof===REACT_ELEMENT_TYPE}(value)}(value)};var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(value,options){return!1!==options.clone&&options.isMergeableObject(value)?deepmerge(function emptyTarget(val){return Array.isArray(val)?[]:{}}(value),value,options):value}function defaultArrayMerge(target,source,options){return target.concat(source).map(function(element){return cloneUnlessOtherwiseSpecified(element,options)})}function deepmerge(target,source,options){(options=options||{}).arrayMerge=options.arrayMerge||defaultArrayMerge,options.isMergeableObject=options.isMergeableObject||isMergeableObject;var sourceIsArray=Array.isArray(source);return sourceIsArray===Array.isArray(target)?sourceIsArray?options.arrayMerge(target,source,options):function mergeObject(target,source,options){var destination={};return options.isMergeableObject(target)&&Object.keys(target).forEach(function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options)}),Object.keys(source).forEach(function(key){options.isMergeableObject(source[key])&&target[key]?destination[key]=deepmerge(target[key],source[key],options):destination[key]=cloneUnlessOtherwiseSpecified(source[key],options)}),destination}(target,source,options):cloneUnlessOtherwiseSpecified(source,options)}deepmerge.all=function deepmergeAll(array,options){if(!Array.isArray(array))throw new Error("first argument should be an array");return array.reduce(function(prev,next){return deepmerge(prev,next,options)},{})};var deepmerge_1=deepmerge;function mixin(target,source){target=target.prototype,source=source.prototype,Object.getOwnPropertyNames(source).forEach(function(name){"constructor"!==name&&Object.defineProperty(target,name,Object.getOwnPropertyDescriptor(source,name))})}function resolveSchema(schema){return schema.hasOwnProperty("allOf")&&(schema=function mergeAllOf(allOfList){return deepmerge_1.all(allOfList)}(schema.allOf)),schema}function logger(message){Mutt.config.getSetting("debug")&&console.log("Mutt :: ",message)}var _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass$1=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var ArrayField=function(_Field){function ArrayField(_ref){var id=_ref.id,name=_ref.name,_ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$initial=_ref.initial,initial=void 0===_ref$initial?null:_ref$initial,_ref$widget=_ref.widget,widget=void 0===_ref$widget?null:_ref$widget,_ref$validators=_ref.validators,validators=void 0===_ref$validators?[]:_ref$validators,_ref$attribs=_ref.attribs,attribs=void 0===_ref$attribs?{}:_ref$attribs,_ref$description=_ref.description,description=void 0===_ref$description?null:_ref$description,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,_ref$order=_ref.order,order=void 0===_ref$order?null:_ref$order,_ref$parent=_ref.parent,parent=void 0===_ref$parent?null:_ref$parent,_ref$items=_ref.items,items=void 0===_ref$items?{}:_ref$items,_ref$minItems=_ref.minItems,minItems=void 0===_ref$minItems?1:_ref$minItems,_ref$maxItems=_ref.maxItems,maxItems=void 0===_ref$maxItems?null:_ref$maxItems;!function _classCallCheck$4(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ArrayField);var _this=function _possibleConstructorReturn$1(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.call(this,{id:id,name:name,label:label,initial:initial,widget:widget,validators:validators,attribs:attribs,description:description,options:options,order:order,parent:parent}));_this.minItems=minItems,_this.maxItems=maxItems>=minItems?maxItems:null,_this.itemSchema=resolveSchema(items),_this.itemOptions=options,_this.slots=[];var buildPlaceholders=!0;if(_this.options.hasOwnProperty("disablePlaceholders")&&(buildPlaceholders=!_this.options.disablePlaceholders),buildPlaceholders)for(var i in Array.from(Array(_this.minItems).keys()))_this.addSlot(!1);return _this.validators.push(new LengthValidator({min:_this.minItems,max:_this.maxItems})),_this._errors=[],_this}return function _inherits$1(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ArrayField,_Field),ArrayField.prototype.addSlot=function addSlot(){var updateWidget=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],position=this.slots.length+1,fieldId=this.getSlotId(position),fieldName=this.getSlotName(position),fieldOptions=Object.assign({order:position},this.itemOptions),field=this.constructor.new(fieldId,fieldName,this.itemSchema,fieldOptions,this);this.slots.push(field),updateWidget&&this.widget.hasOwnProperty("addSlot")&&this.widget.addSlot(field)},ArrayField.prototype.removeSlot=function removeSlot(){var updateWidget=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return 0!==this.slots.length&&(this.slots.pop(),updateWidget&&this.widget.hasOwnProperty("removeSlot")&&this.widget.removeSlot(),!0)},ArrayField.prototype.spliceSlot=function spliceSlot(index){var updateWidget=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0===this.slots.length)return!1;for(var slotIndex in this.slots)slotIndex=parseInt(slotIndex),updateWidget&&slotIndex===index&&this.slots[slotIndex].destroy();for(var _slotIndex in this.slots.splice(index,1),this.slots){var position=parseInt(_slotIndex)+1,newId=this.getSlotId(position),newName=this.getSlotName(position),slot=this.slots[_slotIndex];slot.updateId(newId,updateWidget),slot.updateName(newName,updateWidget)}return!0},ArrayField.prototype.getSlotId=function getSlotId(index){return this.id+"_item_"+index},ArrayField.prototype.getSlotName=function getSlotName(index){return this.name+"_"+index},ArrayField.prototype.getSerializedValue=function getSerializedValue(){if(!this.options.hasOwnProperty("serialize")){var valueArray=[],_iterator=this.slots,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref2=_i.value}var slot=_ref2;valueArray.push(slot.getSerializedValue())}return valueArray}var serializeArgs=this.options.serialize,serializeKey=void 0,serializeOptions={};if("object"===(void 0===serializeArgs?"undefined":_typeof$1(serializeArgs))?(serializeKey=serializeArgs.name,serializeOptions=serializeArgs):serializeKey=serializeArgs,Mutt.config.hasSerializer(serializeKey))return new(Mutt.config.getSerializer(serializeKey))(this.value,serializeOptions).serialize()},ArrayField.prototype.validate=function validate(){if(this.refreshValidationState(),this.validators.length>0){var _iterator2=this.validators,_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref3;if(_isArray2){if(_i2>=_iterator2.length)break;_ref3=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref3=_i2.value}var validator=_ref3;validator.validate(this.value)||(this.errors=validator.error)}}if(this.errors.length>0)return this.widget.refreshErrorState(this.errors),!1;var valid=!0,_iterator3=this.slots,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref4;if(_isArray3){if(_i3>=_iterator3.length)break;_ref4=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref4=_i3.value}_ref4.validate()||(valid=!1)}return valid},ArrayField.prototype.refreshValidationState=function refreshValidationState(){_Field.prototype.refreshValidationState.call(this),this._errors=[]},ArrayField.prototype.postRender=function postRender(){var _iterator4=this.slots,_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref5;if(_isArray4){if(_i4>=_iterator4.length)break;_ref5=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref5=_i4.value}_ref5.postRender()}},ArrayField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("array")},ArrayField.prototype.render=function render(){return this.widget.renderList(this.slots)},ArrayField.prototype.getFieldByPath=function getFieldByPath(path){var pathParts=path.split("."),searchIndex=parseInt(pathParts.shift());if(isNaN(searchIndex))return null;if(searchIndex>this.slots.length)return null;var field=this.slots[searchIndex];return 0===pathParts.length?field:field.constructor.prototype.hasOwnProperty("getFieldByPath")?field.getFieldByPath(pathParts.join(".")):null},_createClass$1(ArrayField,[{key:"value",get:function get(){var valueArray=[],_iterator5=this.slots,_isArray5=Array.isArray(_iterator5),_i5=0;for(_iterator5=_isArray5?_iterator5:_iterator5[Symbol.iterator]();;){var _ref6;if(_isArray5){if(_i5>=_iterator5.length)break;_ref6=_iterator5[_i5++]}else{if((_i5=_iterator5.next()).done)break;_ref6=_i5.value}var slot=_ref6;valueArray.push(slot.value)}return valueArray},set:function set(value){if(!Array.isArray(value))throw new Error("Unable to set array field value(s) from non-array!");if(value.length>this.slots.length){var difference=value.length-this.slots.length,_iterator6=Array(difference).keys(),_isArray6=Array.isArray(_iterator6),_i6=0;for(_iterator6=_isArray6?_iterator6:_iterator6[Symbol.iterator]();;){if(_isArray6){if(_i6>=_iterator6.length)break;_iterator6[_i6++]}else{if((_i6=_iterator6.next()).done)break;_i6.value}this.addSlot()}}else value.length<this.slots.length&&(this.slots=this.slots.slice(0,value.length));var _iterator7=this.slots.map(function(field,index){return[field,value[index]]}),_isArray7=Array.isArray(_iterator7),_i7=0;for(_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref9;if(_isArray7){if(_i7>=_iterator7.length)break;_ref9=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)break;_ref9=_i7.value}var _ref8=_ref9,field=_ref8[0],_value=_ref8[1];field.value=_value}}}]),ArrayField}(Field);var ButtonField=function(_Field){function ButtonField(){return function _classCallCheck$5(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ButtonField),function _possibleConstructorReturn$2(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.apply(this,arguments))}return function _inherits$2(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ButtonField,_Field),ButtonField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("button")},ButtonField}(Field),_createClass$2=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var BooleanField=function(_Field){function BooleanField(){return function _classCallCheck$6(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BooleanField),function _possibleConstructorReturn$3(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.apply(this,arguments))}return function _inherits$3(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(BooleanField,_Field),BooleanField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("checkbox")},_createClass$2(BooleanField,[{key:"value",get:function get(){return function toBool(value){if(void 0===value||null===value)return null;if("boolean"==typeof value)return value;switch(value.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(value)}}(this.widget.getValue())},set:function set(value){this.widget.setValue(value)}}]),BooleanField}(Field);var ChoiceField=function(_Field){function ChoiceField(_ref){var id=_ref.id,name=_ref.name,_ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$initial=_ref.initial,initial=void 0===_ref$initial?null:_ref$initial,_ref$widget=_ref.widget,widget=void 0===_ref$widget?null:_ref$widget,_ref$validators=_ref.validators,validators=void 0===_ref$validators?[]:_ref$validators,_ref$attribs=_ref.attribs,attribs=void 0===_ref$attribs?{}:_ref$attribs,_ref$description=_ref.description,description=void 0===_ref$description?null:_ref$description,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,_ref$order=_ref.order,order=void 0===_ref$order?null:_ref$order,_ref$parent=_ref.parent,parent=void 0===_ref$parent?null:_ref$parent,_ref$choices=_ref.choices,choices=void 0===_ref$choices?[]:_ref$choices;!function _classCallCheck$7(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChoiceField);var _this=function _possibleConstructorReturn$4(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.call(this,{id:id,name:name,label:label,initial:initial,widget:widget,validators:validators,attribs:attribs,description:description,options:options,order:order,parent:parent}));return _this.choices=choices,options.hasOwnProperty("choices")&&(_this.choices=options.choices),_this.widget.hasOwnProperty("setChoices")&&_this.widget.setChoices(_this.choices),_this}return function _inherits$4(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ChoiceField,_Field),ChoiceField.prototype.getWidget=function getWidget(){return this.options.hasOwnProperty("widget")&&"checkboxlist"===this.options.widget?Mutt.config.getWidget("checkboxlist"):Mutt.config.getWidget("select")},ChoiceField}(Field),_createClass$3=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var IntegerField=function(_Field){function IntegerField(_ref){var id=_ref.id,name=_ref.name,_ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$initial=_ref.initial,initial=void 0===_ref$initial?null:_ref$initial,_ref$widget=_ref.widget,widget=void 0===_ref$widget?null:_ref$widget,_ref$validators=_ref.validators,validators=void 0===_ref$validators?[]:_ref$validators,_ref$attribs=_ref.attribs,attribs=void 0===_ref$attribs?{}:_ref$attribs,_ref$description=_ref.description,description=void 0===_ref$description?null:_ref$description,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,_ref$order=_ref.order,order=void 0===_ref$order?null:_ref$order,_ref$parent=_ref.parent,parent=void 0===_ref$parent?null:_ref$parent;!function _classCallCheck$8(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,IntegerField);var _this=function _possibleConstructorReturn$5(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.call(this,{id:id,name:name,label:label,initial:initial,widget:widget,validators:validators,attribs:attribs,description:description,options:options,order:order,parent:parent}));return _this.validators.push(new IntegerValidator),_this}return function _inherits$5(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(IntegerField,_Field),IntegerField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("number")},_createClass$3(IntegerField,[{key:"value",get:function get(){var value=this.widget.getValue();return value||0===value?parseInt(value):""},set:function set(value){this.widget.setValue(value)}}]),IntegerField}(Field),_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass$4=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var ObjectField=function(_Field){function ObjectField(_ref){var id=_ref.id,name=_ref.name,_ref$label=_ref.label,label=void 0===_ref$label?null:_ref$label,_ref$initial=_ref.initial,initial=void 0===_ref$initial?null:_ref$initial,_ref$widget=_ref.widget,widget=void 0===_ref$widget?null:_ref$widget,_ref$validators=_ref.validators,validators=void 0===_ref$validators?[]:_ref$validators,_ref$attribs=_ref.attribs,attribs=void 0===_ref$attribs?{}:_ref$attribs,_ref$description=_ref.description,description=void 0===_ref$description?null:_ref$description,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,_ref$order=_ref.order,order=void 0===_ref$order?null:_ref$order,_ref$parent=_ref.parent,parent=void 0===_ref$parent?null:_ref$parent,_ref$properties=_ref.properties,properties=void 0===_ref$properties?{}:_ref$properties,_ref$required=_ref.required,required=void 0===_ref$required?[]:_ref$required;!function _classCallCheck$9(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ObjectField);var _this=function _possibleConstructorReturn$6(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.call(this,{id:id,name:name,label:label,initial:initial,widget:widget,validators:validators,attribs:attribs,description:description,options:options,order:order,parent:parent}));_this.object={};var fieldIndex=1,resolvedProps=resolveSchema(properties),_iterator=Object.keys(resolvedProps),_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref2=_i.value}var fieldName=_ref2,fieldId=name+"_"+fieldName,fieldOptions={},fieldRequired=!1;_this.options.hasOwnProperty(fieldName)&&(fieldOptions=options[fieldName]),required.length>0&&-1!==required.indexOf(fieldName)&&(fieldRequired=!0);var field=_this.constructor.new(fieldId,fieldName,resolvedProps[fieldName],fieldOptions,_this,fieldRequired);if(!field)throw new Error('Unable to create "'+fieldId+'" on '+id+" (ObjectField)!");field.getSortOrder()||field.setSortOrder(fieldIndex),_this.object[fieldName]=field,fieldIndex++}return _this._errors={},_this}return function _inherits$6(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ObjectField,_Field),ObjectField.prototype.getSerializedValue=function getSerializedValue(){if(!this.options.hasOwnProperty("serialize")){var values={},_iterator2=Object.keys(this.object),_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref3;if(_isArray2){if(_i2>=_iterator2.length)break;_ref3=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref3=_i2.value}var key=_ref3;values[key]=this.object[key].getSerializedValue()}return values}var serializeArgs=this.options.serialize,serializeKey=void 0,serializeOptions={};if("object"===(void 0===serializeArgs?"undefined":_typeof$2(serializeArgs))?(serializeKey=serializeArgs.name,serializeOptions=serializeArgs):serializeKey=serializeArgs,Mutt.config.hasSerializer(serializeKey))return new(Mutt.config.getSerializer(serializeKey))(this.value,serializeOptions).serialize()},ObjectField.prototype.validate=function validate(){var valid=!0;if(Object.values(this.object).forEach(function(field){return field.validate()}),this.validators.length>0){var _iterator3=this.validators,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref4;if(_isArray3){if(_i3>=_iterator3.length)break;_ref4=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref4=_i3.value}var validator=_ref4;if(!validator.validate(this.value)){var _iterator4=Object.entries(validator.error),_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref6;if(_isArray4){if(_i4>=_iterator4.length)break;_ref6=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref6=_i4.value}var _ref5=_ref6,fieldName=_ref5[0],error=_ref5[1],field=this.object[fieldName];field.errors=error,field.widget.refreshErrorState(field.errors)}}}}var _iterator5=Object.keys(this.object),_isArray5=Array.isArray(_iterator5),_i5=0;for(_iterator5=_isArray5?_iterator5:_iterator5[Symbol.iterator]();;){var _ref7;if(_isArray5){if(_i5>=_iterator5.length)break;_ref7=_iterator5[_i5++]}else{if((_i5=_iterator5.next()).done)break;_ref7=_i5.value}var key=_ref7,_field=this.object[key];_field.errors.length&&(this._errors[key]=_field.errors,valid=!1)}return valid},ObjectField.prototype.refreshValidationState=function refreshValidationState(){_Field.prototype.refreshValidationState.call(this),this._errors={}},ObjectField.prototype.postRender=function postRender(){var _iterator6=Object.keys(this.object),_isArray6=Array.isArray(_iterator6),_i6=0;for(_iterator6=_isArray6?_iterator6:_iterator6[Symbol.iterator]();;){var _ref8;if(_isArray6){if(_i6>=_iterator6.length)break;_ref8=_iterator6[_i6++]}else{if((_i6=_iterator6.next()).done)break;_ref8=_i6.value}var key=_ref8;this.object[key].postRender()}},ObjectField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("object")},ObjectField.prototype.render=function render(){return this.widget.renderObject(this.object)},ObjectField.prototype.getFieldByPath=function getFieldByPath(path){var pathParts=path.split("."),searchName=pathParts.shift(),_iterator7=Object.keys(this.object),_isArray7=Array.isArray(_iterator7),_i7=0;for(_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref9;if(_isArray7){if(_i7>=_iterator7.length)break;_ref9=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)break;_ref9=_i7.value}var key=_ref9,field=this.object[key];if(field.name===searchName){var fieldProto=field.constructor.prototype;if(0===pathParts.length)return field;if(fieldProto.hasOwnProperty("getFieldByPath"))return field.getFieldByPath(pathParts.join("."))}}return null},_createClass$4(ObjectField,[{key:"value",get:function get(){var values={},_iterator8=Object.keys(this.object),_isArray8=Array.isArray(_iterator8),_i8=0;for(_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref10;if(_isArray8){if(_i8>=_iterator8.length)break;_ref10=_iterator8[_i8++]}else{if((_i8=_iterator8.next()).done)break;_ref10=_i8.value}var key=_ref10;values[key]=this.object[key].value}return values},set:function set(values){if(values){if("object"!==(void 0===values?"undefined":_typeof$2(values)))throw new Error("Unable to set object field value(s) from non-object!");var _iterator9=Object.keys(values),_isArray9=Array.isArray(_iterator9),_i9=0;for(_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref11;if(_isArray9){if(_i9>=_iterator9.length)break;_ref11=_iterator9[_i9++]}else{if((_i9=_iterator9.next()).done)break;_ref11=_i9.value}var key=_ref11;this.object.hasOwnProperty(key)&&(this.object[key].value=values[key])}}}},{key:"errors",get:function get(){return this._errors},set:function set(error){this._errors=error}}]),ObjectField}(Field);var StringField=function(_Field){function StringField(){return function _classCallCheck$10(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StringField),function _possibleConstructorReturn$7(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Field.apply(this,arguments))}return function _inherits$7(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(StringField,_Field),StringField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("text")},StringField.prototype.initialValue=function initialValue(){return""},StringField}(Field),fields=Object.freeze({Field:Field,ArrayField:ArrayField,ButtonField:ButtonField,BooleanField:BooleanField,ChoiceField:ChoiceField,IntegerField:IntegerField,ObjectField:ObjectField,StringField:StringField});var Widget=function(){function Widget(field,type,id,name,label){var attribs=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},options=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},initial=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;!function _classCallCheck$11(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Widget),this._field=field,this._rendered=!1,this.type=type,this.id=id,this.name=name,this.label=label,this.attribs=attribs,this.options=options,this.value=initial,this.locked=!1,this.errors=[]}return Widget.prototype.render=function render(){var widgetFragment=document.createDocumentFragment(),wrapper=this.renderWrapper(),label=this.renderLabel(),field=this.renderField(),help=this.renderHelp(),errors=this.renderErrors();return label&&wrapper.appendChild(label),wrapper.appendChild(field),help&&wrapper.appendChild(help),errors&&wrapper.appendChild(errors),widgetFragment.appendChild(wrapper),this._rendered=!0,widgetFragment},Widget.prototype.destroy=function destroy(){var wrapper=this.getElementWrapper();return wrapper.parentNode.removeChild(wrapper),!0},Widget.prototype.postRender=function postRender(){},Widget.prototype.lock=function lock(){if(this.locked)return!1;var wrapper=this.getElementWrapper(),element=this.getElement();return wrapper.removeChild(element),this.locked=!0,!0},Widget.prototype.unlock=function unlock(){if(!this.locked)return!1;var wrapper=this.getElementWrapper(),element=this.getElement();wrapper.removeChild(element);var field=this.renderField();return wrapper.appendChild(field),this.locked=!1,!0},Widget.prototype.updateId=function updateId(oldId,newId){this.getElementWrapper(oldId).id=newId,this.id=newId},Widget.prototype.updateName=function updateName(newName){this.getElement().name=newName,this.name=newName},Widget.prototype.renderField=function renderField(){throw new Error("renderField should be overidden by a widget subclass!")},Widget.prototype.renderWrapper=function renderWrapper(){var wrapper=document.createElement("div");return wrapper.setAttribute("id",this.id),wrapper.className=this.getFieldWrapperClass(),wrapper},Widget.prototype.renderLabel=function renderLabel(){if(this.label){var label=document.createElement("label");return label.setAttribute("for",this.getFieldId()),label.setAttribute("class","mutt-label"),label.textContent=this.label,label}return null},Widget.prototype.renderHelp=function renderHelp(){if(this.options.hasOwnProperty("help")&&this.options.help){var help=document.createElement("span");return help.setAttribute("class","mutt-help"),help.textContent=this.options.help,help}return null},Widget.prototype.renderErrors=function renderErrors(){if(this.errors.length>0){var errorList=document.createElement("ul");errorList.className=this.getErrorClass();var _iterator=this.errors,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var error=_ref,errorItem=document.createElement("li");errorItem.textContent=error,errorList.appendChild(errorItem)}return errorList}return null},Widget.prototype.refreshErrorState=function refreshErrorState(errors){if(this.errors=errors,this._rendered){var elementWrapper=this.getElementWrapper(),errorElement=this.getElementError(),errorWrapperClass=this.getErrorWrapperClass();if(errorElement&&(elementWrapper.classList.remove(errorWrapperClass),elementWrapper.removeChild(errorElement)),this.errors.length>0){elementWrapper.classList.add(errorWrapperClass);var _errors=this.renderErrors();_errors&&elementWrapper.appendChild(_errors)}}},Widget.prototype.getElementWrapper=function getElementWrapper(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return id||(id=this.id),document.querySelector("#"+id)},Widget.prototype.getElement=function getElement(){return this.getElementWrapper().querySelector(".mutt-field")},Widget.prototype.getElementError=function getElementError(){return this.getElementWrapper().querySelector(".mutt-error")},Widget.prototype.getElementLabel=function getElementLabel(){return this.getElementWrapper().querySelector(".mutt-label")},Widget.prototype.getValue=function getValue(){if(!this._rendered)return this.value;var element=this.getElement();if(!element)throw new Error("Unable to get element!");return this.value=element.value,this.value},Widget.prototype.setValue=function setValue(value){if(this.value=value,this._rendered){var element=this.getElement();element&&(element.value=this.value)}},Widget.prototype.getFieldClass=function getFieldClass(){return this.attribs.hasOwnProperty("class")?"mutt-field "+this.attribs.class:"mutt-field"},Widget.prototype.getFieldWrapperClass=function getFieldWrapperClass(){return"mutt-field-wrapper"},Widget.prototype.getErrorClass=function getErrorClass(){return"mutt-error"},Widget.prototype.getErrorWrapperClass=function getErrorWrapperClass(){return"mutt-error-wrapper"},Widget.prototype.getFieldId=function getFieldId(){return this.name},Widget}();var ArrayInput=function(_Widget){function ArrayInput(){return function _classCallCheck$12(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ArrayInput),function _possibleConstructorReturn$8(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Widget.apply(this,arguments))}return function _inherits$8(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ArrayInput,_Widget),ArrayInput.prototype.renderList=function renderList(fields){var widgetFragment=document.createDocumentFragment(),wrapper=this.renderWrapper();fields.sort(function(a,b){return a.getSortOrder()-b.getSortOrder()});var _iterator=fields,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var renderedField=_ref.render();wrapper.appendChild(renderedField)}return widgetFragment.appendChild(wrapper),this._rendered=!0,widgetFragment},ArrayInput.prototype.render=function render(){throw new Error("ArrayInput must render as a list - use renderList")},ArrayInput.prototype.renderLabel=function renderLabel(){throw new Error("ArrayInput does not support a label!")},ArrayInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-array"},ArrayInput.prototype.getElement=function getElement(){throw new Error("Unable to get element on an array field!")},ArrayInput.prototype.getElementByIndex=function getElementByIndex(index){return this.getElementWrapper().querySelector("#"+this.id+"_item_"+index)},ArrayInput.prototype.addSlot=function addSlot(field){var renderedField=field.render();this.getElementWrapper().appendChild(renderedField),field.postRender()},ArrayInput.prototype.removeSlot=function removeSlot(){var lastFieldIndex=this._field.slots.length,lastField=this.getElementByIndex(lastFieldIndex);this.getElementWrapper().removeChild(lastField)},ArrayInput.prototype.spliceSlot=function spliceSlot(fieldIndex){var splicedField=this.getElementByIndex(fieldIndex);this.getElementWrapper().removeChild(splicedField)},ArrayInput}(Widget);var ButtonWidget=function(_Widget){function ButtonWidget(){return function _classCallCheck$13(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ButtonWidget),function _possibleConstructorReturn$9(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Widget.apply(this,arguments))}return function _inherits$9(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ButtonWidget,_Widget),ButtonWidget.prototype.renderField=function renderField(){var button=document.createElement("button");for(var attrib in button.setAttribute("type","button"),button.setAttribute("class",this.getFieldClass()),this.attribs)button.setAttribute(attrib,this.attribs[attrib]);return button},ButtonWidget.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-button"},ButtonWidget}(Widget);function _classCallCheck$14(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$10(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits$10(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var CheckboxInput=function(_Widget){function CheckboxInput(){return _classCallCheck$14(this,CheckboxInput),_possibleConstructorReturn$10(this,_Widget.apply(this,arguments))}return _inherits$10(CheckboxInput,_Widget),CheckboxInput.prototype.renderField=function renderField(){var _this2=this,checkbox=document.createElement("input");for(var attrib in checkbox.setAttribute("name",this.name),checkbox.setAttribute("id",this.getFieldId()),checkbox.setAttribute("type","checkbox"),checkbox.setAttribute("class",this.getFieldClass()),checkbox.onchange=function(){_this2.setValue(!checkbox.hasAttribute("checked"))},this.value&&checkbox.setAttribute("checked","checked"),this.attribs)checkbox.setAttribute(attrib,this.attribs[attrib]);return this._rendered=!0,checkbox},CheckboxInput.prototype.getValue=function getValue(){return this._rendered?!!this.getElement().hasAttribute("checked"):this.value},CheckboxInput.prototype.setValue=function setValue(value){if(this.value=value,this._rendered){var element=this.getElement();if(element){var label=this.getElementLabel();this.value?(element.setAttribute("checked","checked"),label&&label.classList.add("mutt-field-checkbox-checked")):(element.removeAttribute("checked"),label&&label.classList.remove("mutt-field-checkbox-checked"))}}},CheckboxInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-checkbox"},CheckboxInput.prototype.getFieldId=function getFieldId(){return this.id+"-checkbox"},CheckboxInput}(Widget),CheckboxList=function(_CheckboxInput){function CheckboxList(field,type,id,name,label,attribs,options,value){_classCallCheck$14(this,CheckboxList);var _this3=_possibleConstructorReturn$10(this,_CheckboxInput.call(this,field,type,id,name,label,attribs,options,value));return _this3.value||(_this3.value=[]),_this3}return _inherits$10(CheckboxList,_CheckboxInput),CheckboxList.prototype.renderField=function renderField(){var _this4=this,list=document.createElement("ul");list.setAttribute("id",this.getFieldId());var _loop=function _loop(choice){var listItem=document.createElement("li"),checkbox=document.createElement("input");if(checkbox.setAttribute("type","checkbox"),checkbox.setAttribute("name",_this4.name),checkbox.setAttribute("class",_this4.getFieldClass()),checkbox.setAttribute("data-index",choice),checkbox.setAttribute("id",_this4.id+choice),_this4.options.hasOwnProperty("choices")&&_this4.options.choices[choice][1]){var label=document.createElement("label");label.setAttribute("for",_this4.id+choice),label.textContent=_this4.options.choices[choice][1],listItem.appendChild(label)}for(var attrib in checkbox.onchange=function(){_this4.setValueByIndex(!checkbox.hasAttribute("checked"),checkbox.getAttribute("data-index"))},_this4.value&&_this4.value[choice]&&checkbox.setAttribute("checked","checked"),_this4.attribs)checkbox.setAttribute(attrib,_this4.attribs[attrib]);listItem.appendChild(checkbox),list.appendChild(listItem)};for(var choice in this.choices)_loop(choice);return this._rendered=!0,list},CheckboxList.prototype.getValueByIndex=function getValueByIndex(index){if(!this._rendered)return this.value[index];var element=this.getElementByIndex(index);if(!element)throw new Error("Unable to get element!");return element.hasAttribute("checked")?this.value=!0:this.value=!1,this.value},CheckboxList.prototype.getValue=function getValue(){if(!this._rendered)return this.value;var elements=this.getAllElements();if(!elements)throw new Error("Unable to get elements!");for(var index in Array.from(elements))elements[index].hasAttribute("checked")?this.value[index]=!0:this.value[index]=!1;return this.value},CheckboxList.prototype.setValueByIndex=function setValueByIndex(value,index){if(this.value[index]=value,this._rendered){var element=this.getElementByIndex(index);element&&(this.value[index]?element.setAttribute("checked","checked"):element.removeAttribute("checked"))}},CheckboxList.prototype.setValue=function setValue(value){if(this.value=value,this._rendered){var elements=this.getAllElements();if(value.length!==elements.length)throw new Error("Array Length does not match number of Elements in CheckboxList");for(var index in elements[0].setAttribute("checked","checked"),Array.from(elements))this.value[index]?elements[parseInt(index)].setAttribute("checked","checked"):elements[parseInt(index)].removeAttribute("checked")}},CheckboxList.prototype.setChoices=function setChoices(choices){for(var index in choices)this.value&&void 0===this.value[index]&&(this.value[index]=!1);this.choices=choices},CheckboxList.prototype.getFieldId=function getFieldId(){return this.id+"-checkbox"},CheckboxList.prototype.getChoices=function getChoices(){return this.choices},CheckboxList.prototype.getAllElements=function getAllElements(){return this.getElementWrapper().querySelectorAll(".mutt-field")},CheckboxList.prototype.getElementByIndex=function getElementByIndex(index){return this.getElementWrapper().querySelectorAll(".mutt-field")[index]},CheckboxList}(CheckboxInput);var BaseChoiceWidget=function(_Widget){function BaseChoiceWidget(field,type,id,name,label,attribs,options,value){!function _classCallCheck$15(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BaseChoiceWidget);var _this=function _possibleConstructorReturn$11(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Widget.call(this,field,type,id,name,label,attribs,options,value));return _this.choices=[],_this}return function _inherits$11(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(BaseChoiceWidget,_Widget),BaseChoiceWidget.prototype.setChoices=function setChoices(choices){this.choices=choices},BaseChoiceWidget.prototype.getChoices=function getChoices(){return this.choices},BaseChoiceWidget.prototype.formatLabel=function formatLabel(label){return label?""+(label=label.toLowerCase().replace("_"," ")).charAt(0).toUpperCase()+label.slice(1):label},BaseChoiceWidget.prototype.renderField=function renderField(){throw new Error("Unable to render abstract widget BaseChoiceInput!")},BaseChoiceWidget}(Widget);function _classCallCheck$16(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$12(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits$12(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var DateInput=function(_Widget){function DateInput(){return _classCallCheck$16(this,DateInput),_possibleConstructorReturn$12(this,_Widget.apply(this,arguments))}return _inherits$12(DateInput,_Widget),DateInput.prototype.renderField=function renderField(){var dateInput=document.createElement("input");if(dateInput.setAttribute("name",this.name),dateInput.setAttribute("type","date"),dateInput.setAttribute("value",this.value?this.value:""),dateInput.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("min"))if("now"===this.options.min){var today=new Date;dateInput.setAttribute("min",today.toISOString().slice(0,-14))}else dateInput.setAttribute("min",this.options.min);for(var attrib in this.attribs)dateInput.setAttribute(attrib,this.attribs[attrib]);return dateInput},DateInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-date"},DateInput}(Widget),DateSelectionInput=function(_Widget2){function DateSelectionInput(field,type,id,name,label){var attribs=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},options=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},initial=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;_classCallCheck$16(this,DateSelectionInput);var _this2=_possibleConstructorReturn$12(this,_Widget2.call(this,field,type,id,name,label,attribs,options,null));return _this2.setDateValue(initial),_this2}return _inherits$12(DateSelectionInput,_Widget2),DateSelectionInput.prototype.renderField=function renderField(){var dateWrapper=document.createElement("div");dateWrapper.setAttribute("class","mutt-date-selector");var currentValue=this.getDateValue(),dateInput=document.createElement("input");dateInput.setAttribute("name",this.name),dateInput.setAttribute("type","hidden"),dateInput.setAttribute("value",this.value?this.value:""),dateWrapper.appendChild(dateInput);var dayInput=document.createElement("select");dayInput.setAttribute("name",this.name+"-day");var _iterator=Array.from(Array(31).keys()),_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var day=_ref+1,dayNumberOption=document.createElement("option");dayNumberOption.setAttribute("value",("0"+day).slice(-2)),dayNumberOption.textContent=day,null!==currentValue&&currentValue.getDate()===day&&(dayNumberOption.selected="selected"),dayInput.appendChild(dayNumberOption)}dateWrapper.appendChild(dayInput);var monthInput=document.createElement("select");monthInput.setAttribute("name",this.name+"-month");var months=this.getMonthNames();for(var monthIndex in months){var month=months[monthIndex],monthNameOption=document.createElement("option"),monthNumber=parseInt(monthIndex)+1;monthNumber=("0"+monthNumber).slice(-2),monthNameOption.setAttribute("value",monthNumber),monthNameOption.textContent=month,null!==currentValue&&currentValue.getMonth()===parseInt(monthIndex)&&(monthNameOption.selected="selected"),monthInput.appendChild(monthNameOption)}dateWrapper.appendChild(monthInput);var yearInput=document.createElement("select");yearInput.setAttribute("name",this.name+"-year");var currentYear=(new Date).getFullYear(),thisYear=currentYear,maxYears=20;for(this.options.hasOwnProperty("years")&&(maxYears=this.options.years);thisYear>currentYear-maxYears;){var yearOption=document.createElement("option");yearOption.setAttribute("value",thisYear),yearOption.textContent=thisYear,null!==currentValue&&currentValue.getFullYear()===thisYear&&(yearOption.selected="selected"),yearInput.appendChild(yearOption),thisYear--}return dateWrapper.appendChild(yearInput),dateWrapper},DateSelectionInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-date-selector"},DateSelectionInput.prototype.getElementDay=function getElementDay(){return this.getElementWrapper().querySelector('[name="'+this.name+'-day"]')},DateSelectionInput.prototype.getElementMonth=function getElementMonth(){return this.getElementWrapper().querySelector('[name="'+this.name+'-month"]')},DateSelectionInput.prototype.getElementYear=function getElementYear(){return this.getElementWrapper().querySelector('[name="'+this.name+'-year"]')},DateSelectionInput.prototype.getMonthNames=function getMonthNames(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},DateSelectionInput.prototype.getDateValue=function getDateValue(){if(!this._rendered)return this.value;var elementDay=this.getElementDay(),elementMonth=this.getElementMonth(),elementYear=this.getElementYear();if(!elementDay||!elementMonth||!elementYear)throw new Error("Unable to get element for date!");var value=elementYear.value+"-"+elementMonth.value+"-"+elementDay.value,timestamp=Date.parse(value);if(isNaN(timestamp))return this.value=null,this.value;var dateValue=new Date(timestamp);return this.value=dateValue,this.value},DateSelectionInput.prototype.setDateValue=function setDateValue(value){if("string"==typeof value){var timestamp=Date.parse(value);if(isNaN(timestamp))return;value=new Date(timestamp)}if(this.value=value,this._rendered){var elementDay=this.getElementDay(),elementMonth=this.getElementMonth(),elementYear=this.getElementYear(),date=value.getDate();1===date.toString().length&&(date="0"+date);var month=value.getMonth()+1;1===month.toString().length&&(month="0"+month),elementDay&&elementMonth&&elementYear&&(elementDay.value=date,elementMonth.value=month,elementYear.value=this.value.getFullYear())}},DateSelectionInput.prototype.getValue=function getValue(){return this.getDateValue()},DateSelectionInput.prototype.setValue=function setValue(value){this.setDateValue(value)},DateSelectionInput}(Widget);function _classCallCheck$17(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$13(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits$13(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var NumberInput=function(_Widget){function NumberInput(){return _classCallCheck$17(this,NumberInput),_possibleConstructorReturn$13(this,_Widget.apply(this,arguments))}return _inherits$13(NumberInput,_Widget),NumberInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","number"),textInput.setAttribute("inputmode","numeric"),textInput.setAttribute("class",this.getFieldClass()),textInput.setAttribute("value",null!==this.value?this.value:""),textInput.setAttribute("pattern","[0-9]*"),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},NumberInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-number"},NumberInput}(Widget),CurrencyInput=function(_Widget2){function CurrencyInput(){return _classCallCheck$17(this,CurrencyInput),_possibleConstructorReturn$13(this,_Widget2.apply(this,arguments))}return _inherits$13(CurrencyInput,_Widget2),CurrencyInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","number"),textInput.setAttribute("inputmode","numeric"),textInput.setAttribute("class",this.getFieldClass()),textInput.setAttribute("value",null!==this.value?this.value:""),textInput.setAttribute("pattern","[0-9]*"),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},CurrencyInput.prototype.getValue=function getValue(){var value=_Widget2.prototype.getValue.call(this);return value&&(value=(value=parseFloat(value)).toFixed(2)),parseFloat(value)},CurrencyInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-currency"},CurrencyInput}(Widget);var ObjectInput=function(_Widget){function ObjectInput(){return function _classCallCheck$18(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ObjectInput),function _possibleConstructorReturn$14(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Widget.apply(this,arguments))}return function _inherits$14(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(ObjectInput,_Widget),ObjectInput.prototype.renderObjectFields=function renderObjectFields(wrapper,fields){var allowedFields=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,orderedFields=[],_iterator=Object.keys(fields),_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var key=_ref;if(!allowedFields||Object.keys(allowedFields).includes(key)){var field=fields[key];orderedFields.push([field.getSortOrder(),key])}}orderedFields.sort(function(a,b){return a[0]-b[0]});var _iterator2=orderedFields,_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref2=_i2.value}var renderedField=fields[_ref2[1]].render();wrapper.appendChild(renderedField)}},ObjectInput.prototype.renderObject=function renderObject(fields){var widgetFragment=document.createDocumentFragment(),wrapper=this.renderWrapper();if(this.options.fieldsets){var fieldsetIndex=0,_iterator3=this.options.fieldsets,_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref3;if(_isArray3){if(_i3>=_iterator3.length)break;_ref3=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref3=_i3.value}var fieldset=_ref3,fieldsetElement=document.createElement("fieldset");if(fieldsetElement.classList.add("mutt-fieldset"),fieldsetElement.setAttribute("name",this.name+"-fieldset-"+fieldsetIndex),fieldset.hasOwnProperty("options")&&fieldset.options.hasOwnProperty("class")&&fieldset.options.class)if(fieldset.options.class.includes(" ")){var _iterator4=fieldset.options.class.split(" "),_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref4;if(_isArray4){if(_i4>=_iterator4.length)break;_ref4=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref4=_i4.value}var className=_ref4;fieldsetElement.classList.add(className)}}else fieldsetElement.classList.add(fieldset.options.class);this.renderObjectFields(fieldsetElement,fields,fieldset.fields),wrapper.appendChild(fieldsetElement),fieldsetIndex++}}else this.renderObjectFields(wrapper,fields);return widgetFragment.appendChild(wrapper),this._rendered=!0,widgetFragment},ObjectInput.prototype.render=function render(){throw new Error("ObjectInput must render as a object - use renderObject")},ObjectInput.prototype.renderLabel=function renderLabel(){throw new Error("ObjectInput does not support a label!")},ObjectInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-object"},ObjectInput}(Widget);var RadioInput=function(_BaseChoiceWidget){function RadioInput(field,type,id,name,label,attribs,options,value){!function _classCallCheck$19(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RadioInput);var _this=function _possibleConstructorReturn$15(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_BaseChoiceWidget.call(this,field,type,id,name,label,attribs,options,value));return"boolean"===_this.type&&(options.hasOwnProperty("choices")?_this.choices=options.choices:_this.choices=[[!0,"Yes"],[!1,"No"]]),_this}return function _inherits$15(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(RadioInput,_BaseChoiceWidget),RadioInput.prototype.renderField=function renderField(){var _this2=this,radioInputListWrapper=document.createElement("div"),index=0,_iterator=this.choices,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var choice=_ref,value=choice[0],label=choice[1],fieldId=this.id+"_"+index,radioInputWrapper=document.createElement("div");radioInputWrapper.setAttribute("class","mutt-field-radio-item");var radioInput=document.createElement("input");if(radioInput.setAttribute("id",fieldId),radioInput.setAttribute("type","radio"),radioInput.setAttribute("name",this.id),radioInput.setAttribute("value",value),radioInput.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("callback")&&(radioInput.onclick=function(){return _this2.options.callback(_this2)}),this.attribs)for(var attrib in this.attribs)radioInput.setAttribute(attrib,this.attribs[attrib]);this.value===value&&radioInput.setAttribute("checked","checked");var radioInputLabel=document.createElement("label");radioInputLabel.setAttribute("for",fieldId),radioInputLabel.textContent=this.formatLabel(label),radioInputWrapper.appendChild(radioInput),radioInputWrapper.appendChild(radioInputLabel),radioInputListWrapper.appendChild(radioInputWrapper),index++}return radioInputListWrapper},RadioInput.prototype.getRadioValue=function getRadioValue(){var selectedElement=this.getElementWrapper().querySelector(".mutt-field:checked");return selectedElement?(this.value=selectedElement.value,this.value):null},RadioInput.prototype.getValue=function getValue(){return this.getRadioValue()},RadioInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-radio"},RadioInput}(BaseChoiceWidget);var SelectInput=function(_BaseChoiceWidget){function SelectInput(){return function _classCallCheck$20(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectInput),function _possibleConstructorReturn$16(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_BaseChoiceWidget.apply(this,arguments))}return function _inherits$16(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(SelectInput,_BaseChoiceWidget),SelectInput.prototype.renderField=function renderField(){var selectInput=document.createElement("select");for(var attrib in selectInput.setAttribute("name",this.name),selectInput.setAttribute("class",this.getFieldClass()),this.attribs)selectInput.setAttribute(attrib,this.attribs[attrib]);var _iterator=this.choices,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var choice=_ref,value=choice[0],label=choice[1],option=document.createElement("option");option.value=value,option.textContent=this.formatLabel(label),this.value===value&&option.setAttribute("selected","selected"),selectInput.appendChild(option)}return selectInput},SelectInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-select"},SelectInput}(BaseChoiceWidget);function _classCallCheck$21(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$17(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits$17(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var TextInput=function(_Widget){function TextInput(){return _classCallCheck$21(this,TextInput),_possibleConstructorReturn$17(this,_Widget.apply(this,arguments))}return _inherits$17(TextInput,_Widget),TextInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","text"),textInput.setAttribute("value",this.value?this.value:""),textInput.setAttribute("class",this.getFieldClass()),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},TextInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-text"},TextInput}(Widget),TextAreaInput=function(_Widget2){function TextAreaInput(){return _classCallCheck$21(this,TextAreaInput),_possibleConstructorReturn$17(this,_Widget2.apply(this,arguments))}return _inherits$17(TextAreaInput,_Widget2),TextAreaInput.prototype.renderField=function renderField(){var textareaInput=document.createElement("textarea");for(var attrib in textareaInput.setAttribute("name",this.name),textareaInput.setAttribute("class",this.getFieldClass()),textareaInput.textContent=this.value?this.value:"",this.attribs)textareaInput.setAttribute(attrib,this.attribs[attrib]);return textareaInput},TextAreaInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-text"},TextAreaInput}(Widget),EmailInput=function(_TextInput){function EmailInput(){return _classCallCheck$21(this,EmailInput),_possibleConstructorReturn$17(this,_TextInput.apply(this,arguments))}return _inherits$17(EmailInput,_TextInput),EmailInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","email"),textInput.setAttribute("value",this.value?this.value:""),textInput.setAttribute("class",this.getFieldClass()),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},EmailInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-email"},EmailInput}(TextInput),HiddenInput=function(_Widget3){function HiddenInput(field,type,id,name,label,attribs,options,value){_classCallCheck$21(this,HiddenInput);var _this4=_possibleConstructorReturn$17(this,_Widget3.call(this,field,type,id,name,label,attribs,options,value));return _this4.choices=[],_this4}return _inherits$17(HiddenInput,_Widget3),HiddenInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","hidden"),textInput.setAttribute("value",this.value?this.value:""),textInput.setAttribute("class",this.getFieldClass()),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},HiddenInput.prototype.renderLabel=function renderLabel(){return null},HiddenInput.prototype.renderErrors=function renderErrors(){return null},HiddenInput.prototype.setChoices=function setChoices(choices){this.choices=choices},HiddenInput.prototype.getChoices=function getChoices(){return this.choices},HiddenInput}(Widget),PasswordInput=function(_TextInput2){function PasswordInput(){return _classCallCheck$21(this,PasswordInput),_possibleConstructorReturn$17(this,_TextInput2.apply(this,arguments))}return _inherits$17(PasswordInput,_TextInput2),PasswordInput.prototype.renderField=function renderField(){var textInput=document.createElement("input");for(var attrib in textInput.setAttribute("name",this.name),textInput.setAttribute("type","password"),textInput.setAttribute("value",this.value?this.value:""),textInput.setAttribute("class",this.getFieldClass()),this.attribs)textInput.setAttribute(attrib,this.attribs[attrib]);return textInput},PasswordInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-password"},PasswordInput}(TextInput);var DisplayWidget=function(_Widget4){function DisplayWidget(){return _classCallCheck$21(this,DisplayWidget),_possibleConstructorReturn$17(this,_Widget4.apply(this,arguments))}return _inherits$17(DisplayWidget,_Widget4),DisplayWidget.prototype.renderField=function renderField(){return function displayReadonlyValue(value){var display=document.createElement("span");return display.setAttribute("class","mutt-field mutt-field-display"),display.textContent=value,display}(this.value)},DisplayWidget.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-display"},DisplayWidget}(Widget),widgets=Object.freeze({Widget:Widget,ArrayInput:ArrayInput,ButtonWidget:ButtonWidget,CheckboxInput:CheckboxInput,CheckboxList:CheckboxList,BaseChoiceWidget:BaseChoiceWidget,DateInput:DateInput,DateSelectionInput:DateSelectionInput,NumberInput:NumberInput,CurrencyInput:CurrencyInput,ObjectInput:ObjectInput,RadioInput:RadioInput,SelectInput:SelectInput,TextInput:TextInput,TextAreaInput:TextAreaInput,EmailInput:EmailInput,HiddenInput:HiddenInput,PasswordInput:PasswordInput,DisplayWidget:DisplayWidget});function _classCallCheck$22(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var Serializer=function(){function Serializer(value){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck$22(this,Serializer),this.value=value,this.options=options}return Serializer.prototype.serialize=function serialize(){return this.value},Serializer}(),TrimSerializer=function(_Serializer){function TrimSerializer(){return _classCallCheck$22(this,TrimSerializer),function _possibleConstructorReturn$18(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,_Serializer.apply(this,arguments))}return function _inherits$18(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(TrimSerializer,_Serializer),TrimSerializer.prototype.serialize=function serialize(){return this.value.toString().trim()},TrimSerializer}(Serializer),serializers=Object.freeze({Serializer:Serializer,TrimSerializer:TrimSerializer});var MuttConfig=function(){function MuttConfig(){!function _classCallCheck$23(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MuttConfig),this._config={settings:{debug:!1},fields:{array:ArrayField,boolean:BooleanField,enum:ChoiceField,number:IntegerField,integer:IntegerField,object:ObjectField,string:StringField,date:StringField,datetime:StringField,button:ButtonField},widgets:{array:ArrayInput,checkbox:CheckboxInput,checkboxlist:CheckboxList,date:DateInput,dateselect:DateSelectionInput,number:NumberInput,currency:CurrencyInput,object:ObjectInput,radio:RadioInput,select:SelectInput,text:TextInput,textarea:TextAreaInput,email:EmailInput,hidden:HiddenInput,password:PasswordInput,display:DisplayWidget,button:ButtonWidget},serializers:{trim:TrimSerializer},validators:{required:RequiredValidator,booleanRequired:BooleanRequiredValidator,booleanTrue:BooleanTrueValidator,length:LengthValidator,integer:IntegerValidator,regex:RegexValidator,alpha:AlphaValidator}}}return MuttConfig.prototype.getSetting=function getSetting(name){return this._config.settings.hasOwnProperty(name)?this._config.settings[name]:null},MuttConfig.prototype.setSetting=function setSetting(name,value){this._config.settings[name]=value},MuttConfig.prototype.use=function use(plugin){if(!plugin.hasOwnProperty("install"))throw new Error("Unable to install plugin - missing install!");var pluginComponents={},pluginFeatures=plugin.install();if(Array.isArray(pluginFeatures)){var _fields=pluginFeatures[0],_widgets=pluginFeatures[1],settings=pluginFeatures[2];pluginComponents={fields:_fields,widgets:_widgets,settings:settings}}else pluginComponents=pluginFeatures;pluginComponents.fields&&this.registerFields(pluginComponents.fields),pluginComponents.widgets&&this.registerWidgets(pluginComponents.widgets),pluginComponents.serializers&&this.registerSerializers(pluginComponents.serializers),pluginComponents.settings&&(this._config.settings=Object.assign(this._config.settings,pluginComponents.settings)),pluginComponents.extensions&&Object.keys(pluginComponents.extensions).forEach(function(name){var extension=pluginComponents.extensions[name];MuttForm.prototype[name]=extension})},MuttConfig.prototype.registerField=function registerField(type,fieldKlass){this._config.fields[type]=fieldKlass},MuttConfig.prototype.registerFields=function registerFields(fields){if(fields){var _iterator=Object.keys(fields),_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var fieldType=_ref;this.registerField(fieldType,fields[fieldType])}}},MuttConfig.prototype.hasField=function hasField(type){return!!this._config.fields.hasOwnProperty(type)},MuttConfig.prototype.getField=function getField(type){return this._config.fields.hasOwnProperty(type)?this._config.fields[type]:null},MuttConfig.prototype.registerWidget=function registerWidget(name,widgetKlass){this._config.widgets[name]=widgetKlass},MuttConfig.prototype.registerWidgets=function registerWidgets(widgets){if(widgets){var _iterator2=Object.keys(widgets),_isArray2=Array.isArray(_iterator2),_i2=0;for(_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++]}else{if((_i2=_iterator2.next()).done)break;_ref2=_i2.value}var widgetName=_ref2;this.registerWidget(widgetName,widgets[widgetName])}}},MuttConfig.prototype.hasWidget=function hasWidget(name){return!!this._config.widgets.hasOwnProperty(name)},MuttConfig.prototype.getWidget=function getWidget(name){return this._config.widgets.hasOwnProperty(name)?this._config.widgets[name]:null},MuttConfig.prototype.getWidgets=function getWidgets(){return this._config.widgets},MuttConfig.prototype.registerSerializer=function registerSerializer(name,serializer){this._config.serializers[name]=serializer},MuttConfig.prototype.registerSerializers=function registerSerializers(serializers){if(serializers){var _iterator3=Object.keys(serializers),_isArray3=Array.isArray(_iterator3),_i3=0;for(_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref3;if(_isArray3){if(_i3>=_iterator3.length)break;_ref3=_iterator3[_i3++]}else{if((_i3=_iterator3.next()).done)break;_ref3=_i3.value}var serializerName=_ref3;this.registerSerializer(serializerName,serializers[serializerName])}}},MuttConfig.prototype.hasSerializer=function hasSerializer(name){return!!this._config.serializers.hasOwnProperty(name)},MuttConfig.prototype.getSerializer=function getSerializer(name){return this._config.serializers.hasOwnProperty(name)?this._config.serializers[name]:null},MuttConfig.prototype.getSerializers=function getSerializers(){return this._config.serializers},MuttConfig.prototype.registerValidator=function registerValidator(name,validator){this._config.validators[name]=validator},MuttConfig.prototype.registerValidators=function registerValidators(validators){if(validators){var _iterator4=Object.keys(validators),_isArray4=Array.isArray(_iterator4),_i4=0;for(_iterator4=_isArray4?_iterator4:_iterator4[Symbol.iterator]();;){var _ref4;if(_isArray4){if(_i4>=_iterator4.length)break;_ref4=_iterator4[_i4++]}else{if((_i4=_iterator4.next()).done)break;_ref4=_i4.value}var validatorName=_ref4;this.registerValidator(validatorName,validators[validatorName])}}},MuttConfig.prototype.hasValidator=function hasValidator(name){return!!this._config.validators.hasOwnProperty(name)},MuttConfig.prototype.getValidator=function getValidator(name){return this._config.validators.hasOwnProperty(name)?this._config.validators[name]:null},MuttConfig.prototype.getValidators=function getValidators(){return this._config.validators},MuttConfig}(),packageJson_version="2.1.0";function Mutt(schema){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.config.setSetting("debug",!0),void 0===schema)throw new Error("You must specify a Schema!");return new MuttForm(schema,options)}return function initApi(Mutt){var config=new MuttConfig;Mutt.config=config,Mutt.use=function(plugins){Array.isArray(plugins)||(plugins=[plugins]);var _iterator=plugins,_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if((_i=_iterator.next()).done)break;_ref=_i.value}var plugin=_ref;Mutt.config.use(plugin)}},Mutt.logger=logger,Mutt.mixin=mixin,Mutt.fields=fields,Mutt.widgets=widgets,Mutt.validators=validators,Mutt.serializers=serializers}(Mutt),Mutt.version=packageJson_version,Mutt}();
